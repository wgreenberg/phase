<html>
<head>
<script>

async function loadBuffer(ctx, path) {
    const response = await fetch(path);
    const arrayBuffer = await response.arrayBuffer();
    const audioBuffer = await ctx.decodeAudioData(arrayBuffer);
    return audioBuffer;
}

async function loadNotes(ctx, volume, notes) {
    return await Promise.all(notes.map(async (note) => {
        let source = ctx.createBufferSource();
        source.buffer = await loadBuffer(ctx, `samples/${volume}/${note}.mp3`);
        source.connect(ctx.destination);
        return source;
    }));
}

window.addEventListener('load', async () => {
    setTimeout(() => location.reload(), 3000);
    const ctx = new AudioContext();
    const notes = await loadNotes(ctx, 'mf', ['C3', 'E3', 'G3', 'B3']);
    notes.map(note => note.start());
});
</script>
</head>
<body>
</body>
</html>
